
var edu_list = [{
  eduId: 1,
  eduName: '中学',
  country: [1,2,3,4,5,51,52,103]
}, {
  eduId: 2,
  eduName: '本科',
  country: [1,2,3,4,5,50,51,52,53,54,55,100,101,102,103,
    104,105,106,107,108,109,110,111,112,113,114]
}, {
  eduId: 3,
  eduName: '硕士',
  country: [1,2,3,4,5,50,51,52,53,54,55,100,101,102,103,
    104,105,106,107,108,109,110,111,112,113,114]
}, {
  eduId: 4,
  eduName: '博士',
  country: [1,2,3,4,5,50,53,54,100,101,102]
}]
var tag_list = [{
  tagId : 1,
  tagName: '留学初识',
  country: [1,2,3,4,5,50,51,52,53,54,55,100,101,102,103,
    104,105,106,107,108,109,110,111,112,113,114],
  edu: [1,2,3,4]
}, {
  tagId : 2,
  tagName: '本科选校',
  country: [1,2,3,4,5,50,51,52,53,54,55,100,101,102,103,
    104,105,106,107,108,109,110,111,112,113,114],
  edu: [2]
}, {
  tagId : 3,
  tagName: '硕士选校',
  country: [1,2,3,4,5,50,51,52,53,54,55,100,101,102,103,
    104,105,106,107,108,109,110,111,112,113,114],
  edu: [3]
}, {
  tagId : 4,
  tagName: '留学打工',
  country: [1,2,3,4,5,50,51,52,53,54,55,100,101,102,103,
    104,105,106,107,108,109,110,111,112,113,114],
  edu: [2,3,4]
}, {
  tagId : 5,
  tagName: '本硕连读',
  country: [1,2,3,4,5,50,51,52,53,54,55,100,101,102,103,
    104,105,106,107,108,109,110,111,112,113,114],
  edu: [2,3]
}, {
  tagId : 6,
  tagName: '留学时间',
  country: [1,2,3,4,5,50,51,52,53,54,55,100,101,102,103,
    104,105,106,107,108,109,110,111,112,113,114],
  edu: [1,2,3,4]
}, {
  tagId : 7,
  tagName: '接机住宿',
  country: [1,2,3,4,5,50,51,52,53,54,55,100,101,102,103,
    104,105,106,107,108,109,110,111,112,113,114],
  edu: [1,2,3,4]
}, {
  tagId : 8,
  tagName: '艺术留学',
  country: [1,2,3,4,5,50,51,52,53,54,55,100,101,102,103,
    104,105,106,107,108,109,110,111,112,113,114],
  edu: [2,3,4]
}, {
  tagId : 9,
  tagName: 'QS排名',
  country: [1,2,3,4,5,50,51,52,53,54,55,100,101,102,103,
    104,105,106,107,108,109,110,111,112,113,114],
  edu: [2,3,4]
}, {
  tagId : 10,
  tagName: '留学费用',
  country: [1,2,3,4,5,50,51,52,53,54,55,100,101,102,103,
    104,105,106,107,108,109,110,111,112,113,114],
  edu: [1,2,3,4]
}, {
  tagId : 11,
  tagName: '大学排名',
  country: [1,2,3,4,5,50,51,52,53,54,55,100,101,102,103,
    104,105,106,107,108,109,110,111,112,113,114],
  edu: [2,3,4]
}, {
  tagId : 12,
  tagName: '留学条件',
  country: [1,2,3,4,5,50,51,52,53,54,55,100,101,102,103,
    104,105,106,107,108,109,110,111,112,113,114],
  edu: [1,2,3,4]
}, {
  tagId : 14,
  tagName: '专业解析',
  country: [1,2,3,4,5,50,51,52,53,54,55,100,101,102,103,
    104,105,106,107,108,109,110,111,112,113,114],
  edu: [2,3,4]
}, {
  tagId : 15,
  tagName: '签证指导',
  country: [1,2,3,4,5,50,51,52,53,54,55,100,101,102,103,
    104,105,106,107,108,109,110,111,112,113,114],
  edu: [1,2,3,4]
}, {
  tagId : 16,
  tagName: '就业指导',
  country: [1,2,3,4,5,50,51,52,53,54,55,100,101,102,103,
    104,105,106,107,108,109,110,111,112,113,114],
  edu: [2,3,4]
}, {
  tagId : 17,
  tagName: '申请规划',
  country: [1,2,3,4,5,50,51,52,53,54,55,100,101,102,103,
    104,105,106,107,108,109,110,111,112,113,114],
  edu: [1,2,3,4]
}, {
  tagId : 18,
  tagName: '行前指导',
  country: [1,2,3,4,5,50,51,52,53,54,55,100,101,102,103,
    104,105,106,107,108,109,110,111,112,113,114],
  edu: [1,2,3,4]
}, {
  tagId : 19,
  tagName: '省钱攻略',
  country: [1,2,3,4,5,50,51,52,53,54,55,100,101,102,103,
    104,105,106,107,108,109,110,111,112,113,114],
  edu: [1,2,3,4]
}, {
  tagId : 20,
  tagName: '文书准备',
  country: [1,2,3,4,5,50,51,52,53,54,55,100,101,102,103,
    104,105,106,107,108,109,110,111,112,113,114],
  edu: [1,2,3,4]
}, {
  tagId : 21,
  tagName: '海外生活',
  country: [1,2,3,4,5,50,51,52,53,54,55,100,101,102,103,
    104,105,106,107,108,109,110,111,112,113,114],
  edu: [1,2,3,4]
}, {
  tagId : 22,
  tagName: '院校资讯',
  country: [1,2,3,4,5,50,51,52,53,54,55,100,101,102,103,
    104,105,106,107,108,109,110,111,112,113,114],
  edu: [1,2,3,4]
}, {
  tagId : 23,
  tagName: '背景提升',
  country: [1,2,3,4,5,50,51,52,53,54,55,100,101,102,103,
    104,105,106,107,108,109,110,111,112,113,114],
  edu: [1,2,3,4]
}, {
  tagId : 24,
  tagName: '留学方案',
  country: [1,2,3,4,5,50,51,52,53,54,55,100,101,102,103,
    104,105,106,107,108,109,110,111,112,113,114],
  edu: [1,2,3,4]
}, {
  tagId : 25,
  tagName: '难点解析',
  country: [1,2,3,4,5,50,51,52,53,54,55,100,101,102,103,
    104,105,106,107,108,109,110,111,112,113,114],
  edu: [1,2,3,4]
}, {
  tagId : 26,
  tagName: '备考资讯',
  country: [1,2,3,4,5,50,51,52,53,54,55,100,101,102,103,
    104,105,106,107,108,109,110,111,112,113,114],
  edu: [1,2,3,4]
}, {
  tagId : 27,
  tagName: '院校百科',
  country: [1,2,3,4,5,50,51,52,53,54,55,100,101,102,103,
    104,105,106,107,108,109,110,111,112,113,114],
  edu: [1,2,3,4]
}, {
  tagId : 28,
  tagName: '动漫留学',
  country: [51],
  edu: [2,3]
}, {
  tagId : 29,
  tagName: '本科预科',
  country: [2,4,5],
  edu: [2]
}, {
  tagId : 30,
  tagName: '硕士预科',
  country: [2,4,5],
  edu: [3]
}, {
  tagId : 31,
  tagName: '留学考试',
  country: [1,2,3,4,5,50,51,52,53,54,55,100,102,103,
    104,105,106,107,108,109,110,111,112,113],
  edu: [1,2,3,4]
}, {
  tagId : 32,
  tagName: '职业规划',
  country: [1,2,3,4,5,50,51,52,53,54,55,100,102,103,
    104,105,106,107,108,109,110,111,112,113],
  edu: [2,3,4]
}, {
  tagId : 13,
  tagName: '留学案例',
  country: [1,2,3,4,5,50,51,52,53,54,55,100,102,103,
    104,105,106,107,108,109,110,111,112,113],
  edu: [1,2,3,4]
}]
function screenTag (country,...eduList) {
  //根据国家 学历参数筛选标签
  console.log('参数country ',country)
  console.log('参数学历集合eduList ',eduList)
  let eHtml = '';
  let tHtml = '';
  if (country == 0 && eduList[0] == 0) {
    //默认国家全部 学历全部 循环所有标签
    console.log('默认国家全部 学历全部 循环所有标签')
    for (let eItem of edu_list) {
      eHtml += `
        <span class="level-sel" data-eduId="${eItem.eduId}">
          <i class="level-sel-i iconfont"></i>
          <i>${eItem.eduName}</i>
        </span>
      `;
    }
    $("#eduTag").html(eHtml);
    checkEdu()
    let style = '';
    for (let tItem of tag_list) {
      if (tItem.tagId == 9) {
        style = 'margin-right:38px;';
      } else {
        style = '';
      }
      if (tItem.tagId != 13) {
        tHtml += `
          <span class="recommend-sel" data-str="${tItem.tagName}"
            style="${style}">
            <i class="level-sel-i iconfont"></i>
            <i>${tItem.tagName}</i>
          </span>
        `;
      } else {
        tHtml += `
          <span class="recommend-sel" style="display: block;" data-str="留学案例" id="recommend-sel-case" >
            <i class="level-sel-i iconfont"></i>
            <i>留学案例</i>
            <i class="numTip" style="margin-left:30px;">注：选中【留学案例】标签即发布至顾问个人主页-案例中
            </i>
          </span>
        `;
      }
    }
    $('#tag').html(tHtml);
    checkTag()
  } else if(country == 0 && eduList[0] != 0) {
    //在国家没选择情况下勾选学历 提示选其国家
    console.log('在国家没选择情况下勾选学历 提示选其国家')
    $("#apply-country").focus();
    $("#apply-country").next().html("请选择国家");
    layer.msg('请选择国家');
    return false;
  } else if (country !=0 && eduList[0] == 0) {
    //在选择国家时变换学历这时默认学历为 0
    console.log('在选择国家时变换学历这时默认学历为0')
    let edu_id_List = [];
    for (let eItem of edu_list) {
      if (eItem.country.includes(country)) {
        eHtml += `
          <span class="level-sel" data-eduId="${eItem.eduId}">
            <i class="level-sel-i iconfont"></i>
            <i>${eItem.eduName}</i>
          </span>
        `;
        edu_id_List.push(eItem.eduId)
      }
    }
    $("#eduTag").html(eHtml);
    checkEdu()
    for (let tItem of tag_list) {
      if(tItem.country.includes(country)) {
        for (let eduId of edu_id_List) {
          if (tItem.edu.includes(eduId)) {
            if (tItem.tagId == 9) {
              style = 'margin-right:38px;';
            } else {
              style = '';
            }
            if (tItem.tagId != 13) {
              tHtml += `
                <span class="recommend-sel" data-str="${tItem.tagName}"
                  style="${style}">
                  <i class="level-sel-i iconfont"></i>
                  <i>${tItem.tagName}</i>
                </span>
              `;
            } else {
              tHtml += `
                <span class="recommend-sel" style="display: block;" data-str="留学案例" id="recommend-sel-case" >
                  <i class="level-sel-i iconfont"></i>
                  <i>留学案例</i>
                  <i class="numTip" style="margin-left:30px;">注：选中【留学案例】标签即发布至顾问个人主页-案例中
                  </i>
                </span>
              `;
            }
            break;
          }
        }
      }
    }
    $('#tag').html(tHtml);
    checkTag()
  } else if (country !=0 && eduList[0] != 0) {
    //有国家时 有学历时 变换所有标签
    console.log('有国家时 有学历时 变换所有标签')
    let style = '';
    for (let tItem of tag_list) {
      if(tItem.country.includes(country)) {
        for (let eduId of eduList) {
          if (tItem.edu.includes(eduId)) {
            if (tItem.tagId == 9) {
              style = 'margin-right:38px;';
            } else {
              style = '';
            }
            if (tItem.tagId != 13) {
              tHtml += `
                <span class="recommend-sel" data-str="${tItem.tagName}"
                  style="${style}">
                  <i class="level-sel-i iconfont"></i>
                  <i>${tItem.tagName}</i>
                </span>
              `;
            } else {
              tHtml += `
                <span class="recommend-sel" style="display: block;" data-str="留学案例" id="recommend-sel-case" >
                  <i class="level-sel-i iconfont"></i>
                  <i>留学案例</i>
                  <i class="numTip" style="margin-left:30px;">注：选中【留学案例】标签即发布至顾问个人主页-案例中
                  </i>
                </span>
              `;
            }
            $('#tag').html(tHtml);
            checkTag()
            break;
          }
        }
      }
    }
  }
}
function checkEdu () {
  let eduId_list = [];
  $('.level-sel').on('click',function(){
    //选择学历标签
    let that = this;
    if($(this).attr('checked')){
      $(this).find('.level-sel-i').css({'border':'1px solid #666','color':'none','marginRight':'5px','fontSize':'14px'}).html('');
      $(this).find('.level-sel-i').next().css({'color':'#333'});
      $(this).attr('checked',false);
      eduId_list.findIndex(function(value, index, arr) {
        if(value == Number($(that).attr('data-eduId'))) {
          arr.splice(index,1);
        }
      })
    }else{
      $(this).find('.level-sel-i').css({'border':'none','color':'#c13232','marginRight':'7px','fontSize':'16px'}).html('&#xe640;');
      $(this).find('.level-sel-i').next().css({'color':'#c13232'});
      $(this).attr('checked',true);
      eduId_list.push(Number($(that).attr('data-eduId')))
    }
    if(eduId_list.length == 0) {
      screenTag(Number($('#apply-country').val()), 0)
    } else {
      screenTag(Number($('#apply-country').val()), ...eduId_list)
    }
  })
}
function checkTag () {
  let recNumber = 0;
  $('.recommend-sel').on('click',function(){
    //选择推荐标签
    if($(this).attr('checked')){
      $(this).find('.level-sel-i').css({'border':'1px solid #666','color':'none','marginRight':'5px','fontSize':'14px','lineHeight':'none'}).html('');
      $(this).find('.level-sel-i').next().css({'color':'#333'});
      $(this).attr('checked',false);
    }else{
      if(recNumber<2){
        $(this).find('.level-sel-i').css({'border':'none','color':'#c13232','marginRight':'7px','fontSize':'16px','lineHeight':'18px'}).html('&#xe640;');
        $(this).find('.level-sel-i').next().css({'color':'#c13232'});
        $(this).attr('checked',true);
      }
    }
    recNumber =$('.recommend-sel[checked=checked]').length;
  });
}
