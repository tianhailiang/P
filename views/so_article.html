<!DOCTYPE html>
<html>
{% include "header_new.html" %}
<link rel="stylesheet" href="{{helper.cdnhost}}/dep/css/idangerous.swiper2.7.6.css" >
<script src="{{helper.cdnhost}}/dep/js/idangerous.swiper2.7.6.js"></script>
<style>
    .banner-box{
        margin-top: 20px;
        height: 130px;
        /*background-color: yellow;*/
    }
    .banner-box-left{
        background: #dcdcdc;
        height: 130px;
    }
    .banner-box-right{
        background: #dcdcdc;
        height: 130px;
    }
    .slider .slider-dot ul{
        left:95%;
    }
    .slider .slider-dot ul li{
        border-radius: 50%;
    }
    .slider .slider-btn.slider-btn-right,.slider .slider-btn.slider-btn-left{
        margin-top: -33px
    }
    .main-left{
        padding: 20px 20px 0;
    }
    .main-left .main-searchbox{
        width: 100%;
        height: 40px;
    }
    .main-left .main-searchbox .search-text{
        display: block;
        float: left;
        width: 779px;
        height: 38px;
        border: 1px solid #DCDCDC;
        border-right: none;
        line-height: 38px;
        color: #333;
        font-size: 14px;
        text-indent: 20px;
        background-color: #f8f8f8;
    }
    .main-left .main-searchbox .search-btn {
        float: left;
        width: 60px;
        height: 40px;
        text-align: center;
        background-color: #c13232;
        font-size: 18px;
    }
    .main-left .main-searchbox .search-btn i {
        font-size: 22px;
    }
    .main-left .result-bar{
        font-size: 14px;
        color: #333;
        line-height: 54px;
        height: 54px;
    }
    .main-left .result-bar span{
        color: #C13232;
    }
    .main-left .result-type-bar {
        border: 1px solid #dcdcdc;
        padding: 16px 0;
        border-right: none;
        border-left: none;
    }
    .main-left .result-type-bar a {
        display: inline-block;
        width: 78px;
        height: 24px;
        margin-right: 20px;
        border: 1px solid #C13232;
        text-align: center;
        line-height: 24px;
        color: #C13232;
    }
    .main-left .result-type-bar a.active {
        color: #fff;
        background-color: #C13232;
    }
    .result-item{
        padding: 17px 0 13px;
        border-bottom: 1px dashed #DCDCDC;
    }
    .result-item .item-adviser{
        width: 172px;
        float: left;
    }
    .result-item .item-adviser .adviser-avatar {
        width: 50px;
        height: 50px;
        -webkit-border-radius: 50%;
        -moz-border-radius: 50%;
        border-radius: 50%;
        margin-right: 20px;
        line-height: 50px;
        font-size: 14px;
        color: #333;
    }
    .result-item .item-adviser .flag{
        margin-left: 4px;
        margin-top: -3px;
    }
    .result-item .item-info{
        width: 668px;
        float:right;
    }
    .result-item .item-info .info-top {
        height: 20px;
        line-height: 20px;
    }
    .result-item .item-info .info-top a{
        float: left;
        margin-right: 10px;
        font-size: 16px;
        color: #333;
    }
    .result-item .item-info .info-top .info-tags{
        float: left;
    }
    .result-item .item-info .info-top .info-tags span {
        display: inline-block;
        height: 20px;
        padding: 0 10px;
        background-color: #ff8547;
        color: #fff;
        text-align: center;
        line-height: 20px;
        -webkit-border-radius: 10px;
        -moz-border-radius: 10px;
        border-radius: 10px;
        font-size: 12px;
    }
    .result-item .item-info{
        position: relative;
    }
    .result-item .item-info .info-desc {
        font-size: 12px;
        color: #333;
        line-height: 24px;
        text-align: justify;
    }
    .result-item .item-info .info-desc a{
        color: #C13232;
        cursor: pointer;
    }
    .result-item .item-info .time{
        position: absolute;
        right: 0;
        bottom: 2px;
        font-size: 12px;
    }
    .load-more-article{
        width: 100%;
        height: 48px;
        line-height: 48px;
        text-align: center;
        font-size: 14px;
        color: #333;
        cursor: pointer;
    }
</style>
<body style="background: #f5f5f5">
{% include "widget/top/top.html" %}
{% import "widget/new_nav_first/new_nav_red.html" as new_nav_red %}
{{ new_nav_red.new_nav_red(helper) }}
<div class="dui-layout-lg clearfix banner-box">
    <div class="dui-layout-con banner-box-left">{% include "widget/xSlider/xSlider.html" %}</div>
    <div class="dui-layout-div"></div>
    <div class="dui-layout-silde banner-box-right">{% include "widget/xSlider/xSlider2.html" %}</div>
</div>
<div class="dui-layout-lg clearfix">
    <div class="dui-layout-con" style="background-color: #fff;">
        <div class="main-left">
            <div class="main-searchbox clearfix">
                <input type="text" id="search-page" placeholder="请输入搜索关键词" class="search-text"
                       onfocus="if(this.placeholder == '请输入搜索关键词'){this.value = '';}"
                       onblur="if(this.value == ''){this.placeholder= '请输入搜索关键词';}" value="{{keyword}}">
                <div class="search-btn" id="searchBtn-page" style="cursor: pointer;"><i class="city-icon iconfont">&#xe60c;</i></div>
            </div>
            <div class="result-bar">
                搜索<span id="result-keyword">{{keyword}}</span>共搜索到<span id="result-num">{{article_list.total}}</span>个结果
            </div>
            {% if article_list.total == 0 %}
            <!--没有搜索到数据-->
            <div class="no-result page-blank">
                <img src="{{helper.cdnhost}}/assets/img/blank.png" alt="" class="blank-img"/>
                <span class="blank-info">没有搜索到相关内容，换个关键词试试吧</span>
            </div>
            {% else %}
            <div class="has-result">
                <div class="result-type-bar" data-order="{{order}}" id="result-type-bar">
                    <a href="{{helper.urlgen('so_article','q='+ keyword)}}" {% if order == '' %}class="active"{% else %}{% endif %}>综合</a>
                    <a href="{{helper.urlgen('so_article','q='+ keyword, 'order=add_time')}}" {% if order == 'add_time' %}class="active"{% else %}{% endif %}>最新new</a>
                    <a href="{{helper.urlgen('so_article','q='+ keyword, 'order=views')}}" {% if order == 'views' %}class="active"{% else %}{% endif %}>最热hot</a>
                </div>
                <div class="result-conent" id="result-content">
                    {% for item in article_list.list %}
                    <div class="result-item clearfix">
                        <div class="item-adviser">
                            <a href="{{helper.articleUrlgen('blog',item.user_info.uid | string)}}"><img src="{{helper.avaterimg(item.user_info.uid, 'small', 0,item.user_info.version)}}" alt="" class="adviser-avatar"/></a><span>{{item.user_info.nickname}}</span><img src="../assets/img/1v.png" alt="" class="flag"/>
                        </div>
                        <div class="item-info">
                            <div class="info-top clearfix">
                                <a class="info-title" href="{{helper.articleUrlgen('blog',item.user_info.uid|string,'article='+item.id | string)}}">{{item.title}}</a>
                                <div class="info-tags">
                                    <span>{{item.tag_list}}</span>
                                </div>
                            </div>
                            <div class="info-desc">{{item.introduce|ellipsis(90)}}<a href="{{helper.articleUrlgen('blog',item.user_info.uid|string,'article='+item.id | string)}}">【查看详情】</a></div>
                            <div class="time">{{item.update_time}}</div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                <div class="load-more-article" id="load-more-article" data-page="{{cur_page}}">
                    加载更多
                    <i class="city-icon iconfont">&#xe60b;</i>
                </div>
            </div>
            {% endif %}
        </div>
    </div>
    <div class="dui-layout-div"></div>
    <div class="dui-layout-silde">
        <div class="guess-like-right" style="margin-top: 20px;background-color: #fff;">
            {% include "widget2/guess_like/guess_like.html" %}
        </div>
    </div>
</div>
{% include "widget/new_footer/new_footer.html" %}
{% import "widget/new_slide/new_slide.html" as  slide %}
{{slide.leyu_slide("AD_"+tdk.pagekey+"_SEAT10") }}
<script src="{{helper.cdnhost}}/assets/js/show_advert.js"></script>
<script src="{{helper.cdnhost}}/assets/js/online_evaluation.js" ></script>
<script src="{{helper.cdnhost}}/assets/js/slide.js"></script>
<script src="{{helper.cdnhost}}/assets/js/xSlider.js" ></script>
<script>
    $(function () {
        $('.banner-box-left .slider').xSlider({
            //轮播图配置
//          autoplay : 500,
            current: 0,
            speed: 500,
            intervalTime: 5000,
            pagination: true
        });
        $('.banner-box-right .slider').xSlider({
            //轮播图配置
//          autoplay : 500,
//            mode:'vertical',
            current: 0,
            speed: 1000,
            intervalTime: 5000,
            slidesPerView : 2,
            slidesPerGroup : 2,
//          pagination: true
        });
        var area = $.cookie('currentarea') ? $.cookie('currentarea') : 1;
        var keyword = $('#result-keyword').text();
        var load_page = $('#load-more-article').attr('data-cur_page')*1+1;
        function more_artice (art_list) {
            var artHtml = '';
            for (var i = 0; i < art_list.length; i++) {
                var item = art_list[i];
                artHtml+='<div class="result-item clearfix">'+
                            '<div class="item-adviser">'+
                            '<a href="'+fn.urlgen('blog',item.user_info.uid.toString())+'"><img src="'+fn.avaterimg(item.user_info.uid, 'small', 0,item.user_info.version)+'" alt="" class="adviser-avatar"/></a><span>'+ item.user_info.nickname+ '</span><img src="../assets/img/1v.png" alt="" class="flag"/>'+
                            '</div>'+
                            '<div class="item-info">'+
                            '<div class="info-top clearfix">'+
                            '<a class="info-title" href="'+fn.articleUrlgen('blog',item.user_info.uid.toString(),'article='+item.id.toString())+'">'+ item.title +'</a>'+
                        '<div class="info-tags">'+
                        '<span>'+ item.tag_list +'</span>'+
                    '</div>'+
                    '</div>'+
                    '<div class="info-desc">'+ fn.ellipsis(item.introduce) +'<a href="'+fn.articleUrlgen('blog',item.user_info.uid.toString(),'article='+item.id.toString())+'">【查看详情】</a></div>'+
                '<div class="time">'+ item.update_time +'</div>'+
                '</div>'+
                '</div>';
            }
            $('#result-content').append($(artHtml));
        }
        $('#load-more-article').on('click', function () {
            var page = $(this).data('page')*1+1;
            var thisObj = $(this);
            var per_page = 15;
            var order = $('#result-type-bar').data('order');
            $.ajax({
                url: ajaxUrlPrefix.nodeapi + '/cmsapi/load_more_article',
                datatype: 'json',
                data: {
                    key_word: keyword,
                    city_id: area,
                    "per_page": per_page,
                    "page": page,
                    "order": order
                },
                success: function (revmsg) {
                    if (revmsg.code == 0) {
                        var len = revmsg.data.list.length;
                        if (len == 0) {
                            thisObj.html('文章加载完毕')
                        }
                        else if (0 < len && len < per_page) {
                            thisObj.html('文章加载完毕');
                            more_artice(revmsg.data.list);
                            thisObj.data('page', page);
                        }
                        else {
                            more_artice(revmsg.data.list);
                            thisObj.data('page', page);
                        }
                    }
                    else {
                        thisObj.html('加载更多出错了，请刷新');
                    }
                },
                error: function(XMLHttpRequest, textStatus, errorThrown) {
                    console.log('加载更多出错了！');
                }
            })
        })
    })

</script>
</body>
<script src="{{helper.cdnhost}}/assets/js/nav.js"></script>
<script src="{{helper.cdnhost}}/assets/js/footer.js"></script>
</html>