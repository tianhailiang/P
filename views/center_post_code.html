<!DOCTYPE html>
<html>
{% include "header_new.html" %}
<!--[if lt IE 10]>
<script src="{{helper.cdnhost}}/assets/js/upgrade.js"></script>
<![endif]-->
<body style="background: #f5f5f5">

{% include "widget/top/top.html" %}

{% import "widget/new_nav_first/new_nav_red.html" as new_nav_red %}
{{ new_nav_red.new_nav_red(tdk,helper) }}

<div class="dui-layout-lg clearfix banner-box">
    <div class="dui-layout-silde banner-box-right">{% include "widget/xSlider/xSlider.html" %}</div>
    <div class="dui-layout-div"></div>
    <div class="dui-layout-con banner-box-left">{% include "widget/xSlider/xSlider2.html" %}</div>
</div>

<div class="dui-layout-lg clearfix">
    <div class="dui-layout-silde right">
        <div class="clearfix" style="margin-top: 20px">
            {% if userinfo %}
            {% if login_info.usertype == 1 %} {#用户#}
            {% import "widget2/community_advisor/community_advisor.html" as user %}
            {{ user.user(userinfo,helper) }}
            {% elif login_info.usertype == 2 %} {#顾问#}
            {% import "widget2/community_advisor/community_advisor.html" as advisor %}
            {{ advisor.advisor(userinfo,helper,login_info) }}
            {% elif login_info.usertype == 3 %} {#参赞#}
            {% import "widget2/community_advisor/community_advisor.html" as counsellor %}
            {{ counsellor.counsellor(userinfo,helper,login_info) }}
            {% endif %}
            {% endif %}
        </div>
        {% if login_info.usertype == 2 %} {#顾问#}
        {% import "widget2/side_menu/adviser_side_menu.html" as adviser_side_menu %}
        {{ adviser_side_menu.adviser_side_menu('上传我的二维码', '', helper) }}
        {% elif login_info.usertype == 3 %} {#参赞#}
        {% import "widget2/side_menu/canzan_side_menu.html" as canzan_side_menu %}
        {{ canzan_side_menu.canzan_side_menu('账号设置', '', helper) }}
        {% endif %}
    </div>
    <div class="dui-layout-div"></div>
    <div class="dui-layout-con left" style="border: 1px solid #eee;margin-left: 20px;margin-top: 20px;width: 878px;background: #fff">
        <div class="content_title clearfix">
            <div class="content_title_t">
                上传我的二维码
            </div>
        </div>
        <div class="post-box">
            <div class="post-box-in">
                <div class="code-box weixin-box" id="weixin-box">
                    <div class="code-box-in">
                        <input id="post-wx-code" type="file" multiple="multiple" name="upload" style="display: none;"/>
                        {% if userinfo.weixin_qrcode %}
                        <div class="has-code" style="background-image: url('{{userinfo.weixin_qrcode}}')">
                            <div class="code-mask">
                                <label class="upload-code-btn"  for="post-wx-code">修改我的微信二维码</label>
                            </div>
                        </div>
                        {% else %}
                        <div class="no-code">
                            <img src="../assets/img/post_weixin.png" alt="" class="icon"/>
                            <label class="upload-code-btn" for="post-wx-code">上传我的微信二维码</label>
                            <div class="info">方便用户随时联系我</div>
                        </div>
                        {% endif %}
                        <div class="loading-mask" style="display: none;">正在上传</div>
                    </div>
                </div>
                <div class="code-box qq-box" id="qq-box">
                    <div class="code-box-in">
                        <input id="post-qq-code" type="file" multiple="multiple" name="upload" style="display: none;"/>
                        {% if userinfo.qq_qrcode %}
                        <div class="has-code" style="background-image: url('{{userinfo.qq_qrcode}}')">
                            <div class="code-mask">
                                <label class="upload-code-btn" for="post-qq-code">修改我的QQ二维码</label>
                            </div>
                        </div>
                        {% else %}
                        <div class="no-code">
                            <img src="../assets/img/post_qq.png" alt="" class="icon"/>
                            <label class="upload-code-btn" for="post-qq-code">上传我的QQ二维码</label>
                            <div class="info">方便用户随时联系我</div>
                        </div>
                        {% endif %}
                        <div class="loading-mask" style="display: none;">正在上传</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% include "widget/new_footer/new_footer.html" %}
{% import "widget/new_slide/new_slide2.html" as  slide %}
{{slide.leyu_slide("AD_"+tdk.pagekey+"_SEAT10") }}
<script  src="{{helper.cdnhost}}/assets/js/upload_wx_code.js"></script>
<script  src="{{helper.cdnhost}}/assets/js/upload_qq_code.js"></script>
<script src="{{helper.cdnhost}}/assets/js/layer.min.js"></script>
<script src="{{helper.cdnhost}}/assets/js/xSlider.js" ></script>
<script>
    $('.banner-box-left .slider').xSlider({
        //轮播图配置
//          autoplay : 500,
        current: 0,
        speed: 500,
        intervalTime: 5000,
        pagination: true
    });
    $('.banner-box-right .slider').xSlider({
        //轮播图配置
//          autoplay : 500,
//            mode:'vertical',
        current: 0,
        speed: 1000,
        intervalTime: 5000,
        slidesPerView : 2,
        slidesPerGroup : 2,
          pagination: true
    });
    var login_ss = null;
    if($.cookie('login_ss') != undefined){
        login_ss = JSON.parse($.cookie('login_ss'));
    }
    //微信图片上传
    var params = {
        uid: login_ss.uid,
        fileInput: $("#post-wx-code").get(0),
        url: ajaxUrlPrefix.nodeapi + "/cmsapi/input_upload",
        filter: function(files) {
            var arrFiles = [];
            for (var i = 0, file; file = files[i]; i++) {
                if (file.type.indexOf("image") == 0) {
                    if (file.size >= 1024000) {
                        layer.msg('您这张"'+ file.name +'"图片大小过大，应小于1M');
                    } else {
                        arrFiles.push(file);
                    }
                } else {
                    layer.msg('文件"' + file.name + '"不是图片。');
                }
            }
            return arrFiles;
        },
        onSelect: function(files) {
            console.log('onSelect回调');
        },
        onDragOver: function() {
            $(this).addClass("upload_drag_hover");
        },
        onDragLeave: function() {
            $(this).removeClass("upload_drag_hover");
        },
        onProgress: function(file, loaded, total) {
            /*var eleProgress = $("#uploadProgress_" + file.index), percent = (loaded / total * 100).toFixed(2) + '%';
            eleProgress.show().html(percent);*/
            $('#weixin-box').find('.loading-mask').show();
        },
        onSuccess: function(file, response) {
            var resData = JSON.parse(response);
            console.log('onSuccess~~~thl', resData);
            if (resData.errno == 0) {
                $('#weixin-box').find('.no-code').hide();
                $('#weixin-box').find('.has-code').remove();
                var html ='<div class="has-code" style="background-image: url('+ resData.data[0] +')">'+
                    '<div class="code-mask">'+
                    '<label class="upload-code-btn"  for="post-wx-code">修改我的微信二维码</label>'+
                    '</div>'+
                    '</div>';
                $('#weixin-box').find('.code-box-in').append($(html));
            }
            else {
                layer.msg(resData.message);
            }
            $('#weixin-box').find('.loading-mask').hide();
        },
        onFailure: function(file) {
            $('#weixin-box').find('.loading-mask').hide();
            layer.msg('服务器出小差了，请重试');
        }
    };
    ZXXFILE = $.extend(ZXXFILE, params);
    ZXXFILE.init();
    //qq图片上传
    var paramsQQ = {
        uid: login_ss.uid,
        fileInput: $("#post-qq-code").get(0),
        url: ajaxUrlPrefix.nodeapi + "/cmsapi/input_upload",
        filter: function(files) {
            var arrFiles = [];
            for (var i = 0, file; file = files[i]; i++) {
                if (file.type.indexOf("image") == 0) {
                    if (file.size >= 1024000) {
                        layer.msg('您这张"'+ file.name +'"图片大小过大，应小于1M');
                    } else {
                        arrFiles.push(file);
                    }
                } else {
                    layer.msg('文件"' + file.name + '"不是图片。');
                }
            }
            return arrFiles;
        },
        onSelect: function(files) {
            console.log('onSelect回调');
        },
        onDragOver: function() {
            $(this).addClass("upload_drag_hover");
        },
        onDragLeave: function() {
            $(this).removeClass("upload_drag_hover");
        },
        onProgress: function(file, loaded, total) {
           /* var eleProgress = $("#uploadProgress_" + file.index), percent = (loaded / total * 100).toFixed(2) + '%';
            eleProgress.show().html(percent);*/
            $('#qq-box').find('.loading-mask').show();
        },
        onSuccess: function(file, response) {
            var resData = JSON.parse(response);
            console.log('onSuccess~~~thl', resData);
            if (resData.errno == 0) {
                $('#qq-box').find('.no-code').hide();
                $('#qq-box').find('.has-code').remove();
                var html ='<div class="has-code" style="background-image: url('+ resData.data[0] +')">'+
                        '<div class="code-mask">'+
                        '<label class="upload-code-btn"  for="post-qq-code">修改我的QQ二维码</label>'+
                        '</div>'+
                        '</div>';
                $('#qq-box').find('.code-box-in').append($(html));
            }
            else {
                layer.msg(resData.message);
            }
            $('#qq-box').find('.loading-mask').hide();
        },
        onFailure: function(file) {
            $('#qq-box').find('.loading-mask').hide();
            layer.msg('服务器出小差了，请重试');
        }
    };
    ZXXFILEQQ = $.extend(ZXXFILEQQ, paramsQQ);
    ZXXFILEQQ.init();
</script>
<script src="{{helper.cdnhost}}/assets/js/show_advert.js"></script>
<script src="{{helper.cdnhost}}/assets/js/online_evaluation.js" ></script>
<script src="{{helper.cdnhost}}/assets/js/slide.js"></script>
<script src="{{helper.cdnhost}}/assets/js/follow.js"></script>
<script src="{{helper.cdnhost}}/assets/js/nav.js"></script>
<script src="{{helper.cdnhost}}/assets/js/footer.js"></script>
</body>
</html>
