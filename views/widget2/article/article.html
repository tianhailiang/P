{% macro article_show(item,helper) %}
<div class="homepage">
  <div class="homepagecon">
    <a target="_blank" href="{{helper.urlgen(item.uid | string)}}"><div class="homepageing" style="background:url({{helper.avaterimg(item.uid, 'small',item.user_info.status,item.user_info.version)}}) no-repeat 0 0;background-size: cover;"></div>
    <h3>{{item.user_info.realname}}<img src="{{helper.cdnhost}}/assets/img/1v.png" alt=""></h3></a>
      <ul>
      <div>
        <div class="bdsharebuttonbox" style="margin-top: 15px;">
          <a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信"></a>
          <a href="#" class="bds_weixin weixin-pengyouquan" data-cmd="weixin" title="分享到微信朋友圈"></a>
          <a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
          <a href="#" class="bds_sqq" data-cmd="sqq" title="分享到QQ"></a>
          <div class="report-btn" style="color: #666;font-size: 12px;float: left;margin-top: 6px;margin-right: 5px;" data-artId="{{item.id}}" data-url="{% if item.type == 1 %}{{helper.urlgen('case',item.id | string)}}{% else %}{{helper.urlgen('article',item.id | string)}}{% endif %}">举报</div>
        </div>
      </div>
    </ul>
  </div>
  <div class="homepage-title">
    <p>
    {% if item.type == 1 %}
    <a target="_blank" href="{{helper.urlgen('case',item.id | string)}}" class="dui-text-warning">
      {{item.title}}</a><div>{{item.tag_list}}</div>

    {% else %}
    <a target="_blank" href="{{helper.urlgen('article',item.id | string)}}" class="dui-text-warning">
      {{item.title}}</a><div>{{item.tag_list}}</div>
    {% endif %}
    </p>
  </div>
  <div class="homepage-p">
    <p>
      {% if item.type == 1 %}
      <a target="_blank" href="{{helper.urlgen('case',item.id | string)}}" class="dui-text-warning" rel="nofollow">
        {{item.introduce}}...<span style="color: #C13232">【查看详情】</span>
      </a>
      {% else%}
      <a target="_blank" href="{{helper.urlgen('article',item.id | string)}}" class="dui-text-warning" rel="nofollow">
        {{item.introduce}}...<span style="color: #C13232">【查看详情】</span>
      </a>
      {% endif %}
    </p>
  </div>
  <ul class="homepage-li" style="float: left;margin-left: 20px">
    {% for val in item.img_list %}
    <li>
      {% if item.type == 1 %}
      <a target="_blank" href="{{helper.urlgen('case',item.id | string)}}" class="dui-text-warning" rel="nofollow">
        <img src="{{helper.imageThumb(val,'150x150')}}" >
      </a>
      {% elif item.type == 2 %}
      <a target="_blank" href="{{helper.urlgen('article',item.id | string)}}" class="dui-text-warning" rel="nofollow">
        <img src="{{helper.imageThumb(val,'150x150')}}" >
      </a>
      {% endif %}
    </li>
    {% endfor %}
  </ul>
  <div style="width: 200px;line-height: 38px;float: left;position: relative">
    <div style="float: left;position: absolute;left: 20px">{{item.add_time}}</div>
  </div>
</div>
{% endmacro %}
//顾问、个人中心
{% macro adviser_show(item,helper) %}
<div class="art-box clearfix" >
  <a target="_blank" href="{{helper.urlgen(item.uid|string)}}">
    <div class="adviser-head" style="background:url({{helper.avaterimg(item.uid, 'small',item.user_info.status,item.user_info.version)}}) no-repeat 0 0;background-size: cover;"></div>
  </a>
  <div class="adviser-info" >
     <div class="adviser-info-name" style="font-size: 14px">
       <a target="_blank" href="{{helper.urlgen(item.uid|string)}}" style="color: #333;">{{item.user_info.realname}}</a>
     </div>
     <div class="adviser-info-date clearfix" >
         <span class="adviser-info-date-s" style="color: #666;line-height: 20px;">{{item.add_time}}</span>
     </div>
     <div class="adviser-info-title">
       {% if item.type == 1 %}
       <a target="_blank" href="{{helper.urlgen('case',item.id | string)}}" style="color: #C13232">
         {{item.title}}</a>
       {% else %}
       <a target="_blank" href="{{helper.urlgen('article',item.id | string)}}"  style="color: #C13232">
         {{item.title}}</a>
       {% endif %}
       <span style="font-size: 12px;padding: 0 10px;height: 24px;margin-left: 20px;background: url('{{helper.cdnhost}}/assets/img/yanse.png');background-size:cover ;border-radius:12px ;margin-top: -3px;text-align: center;line-height: 24px;color: #C13232;">{{item.tag_list}}</span>
     </div>
     <p class="adviser-info-p">
       {% if item.type == 1 %}
       <a target="_blank" href="{{helper.urlgen('case',item.id | string)}}" class="dui-text-warning" rel="nofollow">
         {{item.introduce}} <span>【查看详情】</span>
       </a>
       {%else%}
       <a target="_blank" href="{{helper.urlgen('article',item.id | string)}}" class="dui-text-warning" rel="nofollow">
         {{item.introduce}} <span>【查看详情】</span>
       </a>
       {% endif%}
     </p>
      <ul id="adviser-info-ul" class="adviser-info-ul clearfix" >
        {% for val in item.img_list %}
          <li>
          	<img src="{{helper.imageThumb(val,'150x150')}}" >
          </li>
        {% endfor %}
      </ul>
  </div>
</div>
{% endmacro %}
{% macro article_edit(item,helper) %}
<div class="art-box clearfix" >
  <a target="_blank" href="{{helper.urlgen(item.uid | string)}}">
    <div class="adviser-head" style="background:url({{helper.avaterimg(item.uid, 'small',item.user_info.status,item.user_info.version)}}) no-repeat 0 0;background-size: cover;">
    </div>
  </a>
  <div class="adviser-info" >
    <div class="adviser-info-name" style="font-size: 14px" >
      <a target="_blank" href="{{helper.urlgen(item.uid | string)}}" style="color: #333">{{item.user_info.realname}}</a>
    </div>
    <div class="adviser-info-date clearfix" >
      <span class="adviser-info-date-s" style="color: #666;line-height: 20px;">{{item.add_time}}</span>
    </div>
    <div class="adviser-info-title">
      {%if item.type==1%}
      <a target="_blank" href="{% if item.user_info.usertype == 2 %}{{helper.urlgen('case', item.id | string)}}{% elif item.user_info.usertype == 3 %}{{helper.urlgen('case', item.id | string)}}{% endif %}" style="color: #C13232">{{item.title}}</a>
      <span style="font-size: 12px;padding: 0 10px;height: 24px;margin-left: 20px;background: url('{{helper.cdnhost}}/assets/img/yanse.png');background-size:cover ;border-radius:12px ;margin-top: -3px;text-align: center;line-height: 24px;color: #C13232;">{{item.tag_list}}</span>
      {%else %}
      <a target="_blank" href="{% if item.user_info.usertype == 2 %}{{helper.urlgen('article', item.id | string)}}{% elif item.user_info.usertype == 3 %}{{helper.urlgen('article', item.id | string)}}{% endif %}" style="color: #C13232">{{item.title}}</a>
      <span style="font-size: 12px;padding: 0 10px;height: 24px;margin-left: 20px;background: url('{{helper.cdnhost}}/assets/img/yanse.png');background-size:cover ;border-radius:12px ;margin-top: -3px;text-align: center;line-height: 24px;color: #C13232;">{{item.tag_list}}</span>
      {% endif%}
    </div>
    <div class="offer-opt-bar clearfix">
      <div class="opt-btn red-border stick" onclick="stick($(this), {{item.uid}}, {{item.id}})">
        <i class="iconfont">&#xe685;</i><span>置顶</span>
      </div>
      <div class="opt-btn red-border delete" onclick="deleteOffer($(this), {{item.uid}}, {{item.id}})">
        <i class="iconfont">&#xe8c1;</i><span>删除</span>
      </div>
      <div class="opt-btn edit">
        <i class="iconfont">&#xe61c;</i><a target="_blank" href="{% if item.user_info.usertype == 2 %}{{helper.urlgen('advisor_center/postarticle', item.id | string)}}{% elif item.user_info.usertype == 3 %}{{helper.urlgen('canzan_center/postarticle', item.id | string)}}{% endif %}">编辑</a>
      </div>
    </div>
    <p class="adviser-info-p">
      {%if item.type==1%}
      <a target="_blank" href="{% if item.user_info.usertype == 2 %}{{helper.urlgen('case', item.id | string)}}{% elif item.user_info.usertype == 3 %}{{helper.urlgen('case', item.id | string)}}{% endif %}" class="dui-text-warning" rel="nofollow">
        {{item.introduce}} <span>【查看详情】</span>
      </a>
      {%else%}
      <a target="_blank" href="{% if item.user_info.usertype == 2 %}{{helper.urlgen('article', item.id | string)}}{% elif item.user_info.usertype == 3 %}{{helper.urlgen('article', item.id | string)}}{% endif %}" class="dui-text-warning" rel="nofollow">
        {{item.introduce}} <span>【查看详情】</span>
      </a>
      {% endif%}
    </p>
    <ul id="adviser-info-ul" class="adviser-info-ul clearfix" >
      {% for val in item.img_list %}
      <li>
        <img src="{{helper.imageThumb(val,'150x150')}}" >
      </li>
      {% endfor %}
    </ul>
  </div>
</div>
<script>
  var art_box_ = true;
  function deleteOffer (thisObj, uId, articleId) { //删除文章
    // console.log('删除文章' + uId + articleId);
    if(art_box_){
      art_box_ = false;
      $.ajax({
      url: '/soapi/delete_article',
      type: 'POST',
      datatype: 'json',
      data: {
        u_id: uId,
        article_id: articleId
      },
      success: function (result) {
        console.log(result);
        if(result.code == 0){
          layer.msg('删除成功');
          // window.setTimeout(function(){
            window.location.reload();
          // },2000);
          $('#art_box_' + articleId).css('display','none')
        }else{
          layer.msg('删除失败')
        }
        art_box_ = true;
      },
      error: function(XMLHttpRequest, textStatus, errorThrown) {
        console.log(errorThrown)
        art_box_ = true;
      }
      })
    }
    
  }
  function stick (thisObj, uId, articleId) {
    var parent = $(thisObj).parents('.article-list-item');
    var parents = $(thisObj).parents('.right-main');
    if (parent.index() == 0) {
      layer.msg('已经置顶！');
      return false;
    }
    else {
      //调用置顶接口
      $.ajax({
//        url: ajaxUrlPrefix.nodeapi+'/article_top',
        url: '/article_top',
        type: 'POST',
        datatype: 'json',
        data: {
          uid: uId,
          article_id: articleId
        },
        success: function (result) {
          console.log('置顶',result);
          if(result.code == 0){
            console.log(parent);
            console.log(parents);
            parents.prepend(parent);
            layer.msg('置顶成功');
          }else{
            layer.msg('置顶失败')
          }

        },
        error: function(XMLHttpRequest, textStatus, errorThrown) {
          console.log(errorThrown)
        }
      })
    }
  }
</script>
{% endmacro %}

{% macro article_fav(item,helper) %}
<div class="art-box clearfix">
  <a target="_blank" href="{{helper.urlgen(item.uid | string)}}">
    <div class="adviser-head" style="background:url({{helper.avaterimg(item.uid, 'small',item.user_info.status,item.user_info.version)}}) no-repeat 0 0;background-size: cover;"></div>
  </a>
  <div class="adviser-info" >
    <div class="adviser-info-name" style="font-size: 14px" >
      <a target="_blank" href="{{helper.urlgen(item.uid | string)}}" style="color: #333">{{item.user_info.realname}}</a>
    </div>
    <div class="adviser-info-date clearfix" >
      <span class="adviser-info-date-s" style="color: #666;line-height: 20px">{{item.add_time}}</span>
    </div>
    <div class="adviser-info-title">
      {% if item.type == 1 %}
        <a target="_blank" href="{{helper.urlgen('case',item.id | string)}}" style="color: #C13232">
         {{item.title}}
       </a>
      {% else %}
        <a target="_blank" href="{{helper.urlgen('article',item.id | string)}}"  style="color: #C13232">
         {{item.title}}
        </a>
      {% endif %}
      <span style="font-size: 12px;padding: 0 10px;height: 24px;margin-left: 20px;background: url('{{helper.cdnhost}}/assets/img/yanse.png');background-size:cover ;border-radius:12px ;margin-top: -3px;text-align: center;line-height: 24px;color: #C13232;">{{item.tag_list}}</span>
    </div>
    <div class="offer-opt-bar clearfix">
      <div class="opt-btn delete" onclick="cancelFav($(this), {{item.id}})">
        <i class="iconfont">&#xe8c1;</i>
        <span>删除</span>
      </div>
    </div>
    <p class="adviser-info-p">
      {% if item.type == 1 %}
       <a target="_blank" href="{{helper.urlgen('case',item.id | string)}}" class="dui-text-warning" rel="nofollow">
         {{item.introduce}} <span>【查看详情】</span>
       </a>
       {%else%}
       <a target="_blank" href="{{helper.urlgen('article',item.id | string)}}" class="dui-text-warning" rel="nofollow">
        {{item.introduce}} <span>【查看详情】</span>
       </a>
       {% endif%}
    </p>
    <ul id="adviser-info-ul" class="adviser-info-ul clearfix" >
      {% for val in item.img_list %}
      <li>
        <img src="{{helper.imageThumb(val,'150x150')}}" >
      </li>
      {% endfor %}
    </ul>
  </div>
</div>
<script>
  var art_box_ = true;
  function cancelFav (thisObj, articleId) { //取消案例收藏
    if(art_box_){
      art_box_ = false;
      $.ajax({
        url: '/soapi/favorite_article',
        type: 'POST',
        datatype: 'json',
        data: {
          article_id: articleId
        },
        dataType:'jsonp',
        jsonpCallback:'cb',
        success: function (result) {
//        var msg = JSON.parse(result)
//        console.log(msg)
          console.log('fav', result);
          if(result.code == 0){
            layer.msg('删除收藏成功');
            // window.setTimeout(function(){
            window.location.reload();
            // },2000);
            $('#art_box_' + articleId).css('display','none')
          }else{
            layer.msg('删除失败')
          }
          art_box_ = true;
        },
        error: function(XMLHttpRequest, textStatus, errorThrown) {
          console.log(errorThrown)
          art_box_ = true;
        }
      })
    }
  }
</script>
{% endmacro %}
