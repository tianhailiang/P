<!DOCTYPE html>
<html>
<head>

  {% include "header_new.html" %}
  <link rel="stylesheet" type="text/css" href="{{helper.cdnhost}}/assets/css/widget/nav_login.css"/>
  <link rel="stylesheet" type="text/css" href="{{helper.cdnhost}}/assets/css/custom.css"/>

  <script src="{{helper.cdnhost}}/dep/js/layer/layer.js"></script>
  <script src="{{helper.cdnhost}}/assets/js/icheck.min.js"></script>
  <style type="text/css">
    .inputtext_isr{
      -moz-box-sizing: border-box;
      -webkit-box-sizing: border-box;
      -o-box-sizing: border-box;
      -ms-box-sizing: border-box;
      box-sizing: border-box;
    }
    .form-control{
      display: inline-block;
      line-height: 25px;
    }

    .fen img{
      width: 22px;
      height: 22px;
      margin-right: 10px;
      cursor:pointer;
    }
    .inputtext_isr input {
      width: 100%;
      height: 34px;
      color: #999;
      margin-bottom: 15px;
      border-radius: inherit;
      border: 1px solid #ccc;
      border-radius: 4px;
      background-color: #fff;
      background-image: none;
      font-size: 14px;
    }
    .inputtext_isr .login_error{
      background-color: #FFFBEF;
      border: 1px solid #C13232;
      padding: 6px 12px;
      z-index: 1;
      box-shadow: 0 1px 1px #eee;
      color: #C13232;
      position: absolute;
      right: -75px;
      left: 205px;
      top: -19px;
      opacity: 1;
    }
    .inputtext_isr .login_error:after,.login_error:before{
      border: 6px solid transparent;
      content: ' ';
      position: absolute;
      left: 1em;
    }
    .inputtext_isr .login_error:before{
      border-top-color: #C13232;
      bottom: -13px;
    }
    .inputtext_isr .login_error:after{
      border-top-color: #fffbef;
      bottom: -12px;
    }
    .inputtext_isr .login_x{
      width: 9px;
      height: 9px;
      display: inline-block;
      margin-right: 5px;
      background: url({{helper.cdnhost}}/assets/img/login_error_1.png)
    }
    .login_nei{
      width: 440px;
      height: 335px;
      float: right;
      background: #fcf4ef;
      margin-top: -390px;
      margin-right: 5px;
      z-index: 10000;
      padding: 0px;
    }
    .login_nei_top{
      width: 100%;
      height: 40px;
      text-align: center;
      line-height: 40px;
    }
    .login_nei_top .active{
      border-bottom: none;
      background: #fcf4ef;
      color: #c13232;
    }
    .login_nei_title{
      width: 220px;
      height: 40px;
      font-size: 18px;
      color: #333;
      background: #f5f5f5;
      border-bottom: 1px solid #dcdcdc;
      border-right: 1px solid #dcdcdc;
      float: left;
      cursor: pointer;
    }
    .login_form{
      width: 440px;
      height: auto;
      margin-right: 5px;
      padding: 0 72px 0 72px;
      text-align: left;
    }
    .phone_q{
      color: #999;
      position: absolute;
      top: 6px;
      width: 55px;
      left: 30px;
      text-align: center;
    }
    .l_u_com_yan{
    width: 182px;
    height: 40px;
    padding-left: 34px;
    font-size: 14px;
    color: #999;
    border: 1px solid #ccc;
    border-radius: 4px;
    background-color: #fff;
    background-image: none;
  }
  .l_u_com_bang{
    width: 90px;
    height: 40px;
    line-height: 40px;
    float: right;
    margin-right: 45px;
    margin-top: -2px;
  }
  </style>
</head>
<body>
{% include "widget/common_hide/common_hide.html"%}
  {#{% include "widget/top/top.html" %}#}
  <div class="top" style="position:relative;z-index: 1002;">
  </div>

  <div class="main" style="margin: 0 auto;">
    {% import "widget/new_nav_first/nav_login.html" as nav_login %}
    {{ nav_login.nav_login(tdk,helper) }}
  </div>

  <div class="login_overseas clearfix">
    <div style="margin: 0px auto;height: 550px;width: 100%;background: url({{helper.cdnhost}}/assets/img/login_background1.png);
    background-repeat: no-repeat;background-size: cover;background-position-x: -200px;">{# #}
      {# <img src="{{helper.cdnhost}}/assets/img/login_background1.png" alt="" style="width: 100%;height: 550px;display:block;overflow:hidden;"/> #}
    </div>
    <div class="login_content">
      <div class="login_nei text-center loginscreen  animated fadeInDown" style="text-align: left">
        <div class="login_nei_top clearfix">
          <div class="login_nei_title active">账号密码登录</div>
          <div class="login_nei_title" style="border-right: none;">验证码登录</div>
        </div>
        {#<h3 class="login_nei_title" style="font-weight: 400">验证码登录<!--<a target="_blank"  href="{{helper.urlgen('register')}}">注册一个新账号</a>--></h3>
        <!--<div class=" clearfix" id="guwen_login" style="margin-left: -15px;font-size: 18px;">
            <input class="wrap-con" type="radio" name="payMethod" value="1" checked="checked" id="liu"/>&nbsp;&nbsp;&nbsp;&nbsp;<label for="liu">留学顾问</label> 
            <input class="wrap-ing" type="radio" name="payMethod" value="2" id="yi"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<label for="yi">移民顾问</label>
        </div>-->#}
        <div class="login_form">

            <form class="form-group m-t form_password" autocomplete="off" role="form" style="margin-top: 20px;">
                <div class="form-group inputtext_isr" style="position: relative;height: 28px">
                  <input type="text" style="border-radius: inherit;height: 30px;padding-left: 90px;" class="form-control" placeholder="请输入手机号" id="newEmail_pass" required autocomplete="off"/>
                  <i style="color: #999;position: absolute;top: 8px;width: 12px;left: 8px" class="iconfont">&#xe619;</i>
                  <i class="phone_q">+86</i>
                  <span class="login_error" id="login_e_phone_p" style="display: none;"><i class="login_x"></i><em id="login_error_text_phone_p">请输入手机号</em></span>
                </div>
                <div class="form-group inputtext_isr" style="position: relative;height: 28px;margin-top: 20px">
                  <input type="password" style="border-radius: inherit;" class="form-control" placeholder="请输入8-16位数字+字母组成" required="" id="password" autocomplete="new-password">
                  <i style="color: #999;position: absolute;top: 8px;width: 12px;left: 13px" class="iconfont">&#xe606;</i>
                  <span class="login_error" id="login_e_phone_pp" style="display: none;"><i class="login_x"></i><em id="login_error_text_phone_pp">请输入8-16位数字+字母组成</em></span>
                </div>

                  <div class="login_check clearfix" style="margin-top: 20px">
                    <a href="{{helper.urlgen('register')}}?h={{url}}" style="float: left;color: #999">还没有账号？<small style="color: #c13232">免费注册</small></a>
                    <a href="{{helper.urlgen('forgetUser')}}?h={{url}}" style="float: right"><small>忘记密码了</small></a>
                  </div>
      
                <input type="button" class="btn login-primary" style="margin-top: 20px;width: 100%;height: 34px;padding-left: 0;padding-right: 0;border-radius: inherit;border: 1px solid #c13232;" id="loginSubmit_pass" value="立 即 登 录" data-url='{{url}}'/>
            </form>
              

        <form class="form-group m-t form_code" autocomplete="off" role="form" style="margin-top: 20px;display: none">
          <div class="form-group inputtext_isr" style="position: relative;height: 28px">
            <input type="text" style="border-radius: inherit;height: 30px;" class="form-control" placeholder="请输入手机号" id="newEmail" required autocomplete="off" data-errmsg="手机号不正确"/>
            <i style="color: #999;position: absolute;top: 8px;width: 12px;left: 8px" class="iconfont">&#xe619;</i>
            <span class="login_error" id="login_e_phone_u" style="display: none;"><i class="login_x"></i><em id="login_error_text_phone_u">请输入手机号</em></span>
          </div>
          <!--<div class="form-group inputtext_isr" style="position: relative;height: 28px;margin-top: 20px">
            <input type="password" style="border-radius: inherit;" class="form-control" placeholder="密码" required="" data-vaild="^[a-zA-Z0-9]{8,16}$" id="password" data-errmsg="密码不正确，请输入8-16位数字或字母">
            <i style="color: #999;position: absolute;top: 8px;width: 12px;left: 13px" class="iconfont">&#xe606;</i>
          </div>-->
          <div class="form-group clearfix" style="height: 28px;margin-top: 20px;position: relative;margin-bottom: 0px;">
            <input placeholder="填写图形验证码" type="text" id="tupian_user" class="form-control l_u_com_yan" required autocomplete="off" style="padding-left: 0px;text-indent: 30px;border-radius: inherit;height: 30px;line-heigth: 30px;float:left;"/><!--data-errmsg="验证码号码不正确，仅能包含4位数字"-->
            <i style="color: #999;position: absolute;top: 8px;width: 12px;left: 10px" class="iconfont">&#xe606;</i>
            <div class="l_u_com_bang" style="margin-right: 0px;height: 30px;line-heigth: 30px;margin-top: -7px;">
            <!--<input type="button" class="button" id="sendcun" style="color: #999;border: 1px solid #999;font-size: .6rem;width: 3.5rem;padding: 0 .2rem" @click.stop.prevent="sendphone()" value="发送验证码"/>-->
            <!--<img class="" style="width: 90px;height: 30px;" id="tupiancun_user" />-->
            <div id="param_code_user" style="width: 90px;height: 35px;margin-top: -7px;cursor: pointer;"></div>
            </div>
          </div>

          <div class="form-group clearfix" style="margin-top: 20px;position: relative;">
            <input placeholder="请输入短信验证码" type="text" id="verify_user" class="form-control l_u_com_yan" required autocomplete="off" style="padding-left: 0px;text-indent: 30px;border-radius: inherit;height: 30px;line-heigth: 30px;float:left;"/><!--data-errmsg="验证码号码不正确，仅能包含4位数字"-->
            <i style="color: #999;position: absolute;top: 8px;width: 12px;left: 10px" class="iconfont">&#xe606;</i>
            <div class="l_u_com_bang" style="margin-right: 0px;height: 30px;line-heigth: 30px;margin-top: -7px;float: right;">
            <!--<input type="button" class="button" id="sendcun" style="color: #999;border: 1px solid #999;font-size: .6rem;width: 3.5rem;padding: 0 .2rem" @click.stop.prevent="sendphone()" value="发送验证码"/>-->
            <input type="button" class="btn btn-primary" style="width: 90px;height: 30px;text-align: center;padding: 6px 2px;background: #fff;color: #c13232;border: 1px solid #c13232;border-radius: 3px;line-height: 0px;border-radius: inherit;" id="sendcun_user" value="发送验证码"/>
            </div>
          </div>
        

            <!--
            <div class="login_check clearfix" style="">
              <a target="_blank"  href="{{helper.urlgen('forget')}}" style="float: right"><small>忘记密码了？</small></a>
            </div>-->

          <input type="button" class="btn login-primary" style="margin-top: 20px;width: 100%;height: 34px;padding-left: 0;padding-right: 0;border-radius: inherit;border: 1px solid #c13232;" id="loginSubmit" value="立 即 登 录" data-url='{{url}}'/>
          </form>
          <div class="form-group text-left" id="login_user" style="color: #999;margin-top: 20px;margin-left: -0px;">
              <div class="checkbox i-checks" style="color: #999;">
                <label class="no-padding">
                  <input type="checkbox" checked><i></i> 我已阅读并同意</label>
                  <a target="_blank"  href="{{helper.urlgen('agreement', '')}}" style="color: #c13232">金吉列用户使用协议</a>
              </div>
          </div>
        

        <div class="fen" style="margin-top: 15px;">
          <h4 style="line-height: 37px;">第三方快速登录：</h4>
          <div class="bdsharebuttonbox" id="fx" style="float: left;margin-top: 7px;width: 140px;">
            <img src="{{helper.cdnhost}}/assets/img/weibo_login.png" alt="" id="weibo_user" style="float: left;" data-url="{{url}}"/>

            <a target="_blank"  href="{{helper.wwhost}}/weixin_login?h={{url}}" style="float: left;">
              <img src="{{helper.cdnhost}}/assets/img/weixin_login.png" alt=""/>
            </a>
            <img src="{{helper.cdnhost}}/assets/img/QQ_login.png" alt="" id="qq_user" style="float: left;" data-url="{{url}}"/>
          </div>
        </div>

        </div>
      </div>
    </div>
    
    <div class="login_footer">
      <div id="login_data">{{login_ss}}</div>
      ©2009 金吉列出国留学咨询服务有限公司 版权所有 京ICP备05010035号&nbsp;&nbsp;&nbsp;&nbsp;留学投诉电话4006-213-315&nbsp;&nbsp;&nbsp;&nbsp;投诉邮箱：315@jjl.cn
    </div>
  </div>
  <!-- <script src="{{helper.cdnhost}}/assets/js/top.js"></script> -->
  <script src="{{helper.cdnhost}}/assets/js/sha1.js" type="text/javascript" charset="utf-8"></script>
  <script src="{{helper.cdnhost}}/assets/js/nav_common.js"></script>
<script>
    $(document).ready(function () {

        var login_nickname = JSON.parse(cookie('login_ss'));
        var h = window.location.href;
        var hhh = h.split("?");
        var user_type;
        if (login_nickname == null) {
          var val = '<div class="dui-layout-lg top-con">'+
                '<div class="top-con-right">';
                if (hhh[1]) {
                  val += '<span><a href="' + fn.urlgen("register")+"?"+hhh[1] + '" class="dui-text-warning-ss" rel="nofollow">注册</a></span>';
                } else {
                  val += '<span><a href="' + fn.urlgen("register") + '" class="dui-text-warning-ss" rel="nofollow">注册</a></span>';
                }
                val += '<span class="bor"></span>'+
                '<span ><a style="background: #fff;" onclick="window.location.reload();" class="dui-text-warning-ss" rel="nofollow">登录</a></span>'+
                '</div>'+
                '</div>'
          $(".top").append(val);
        } else {
          var val = '<div class="dui-layout-lg top-con">'+
                '<div class="top-con-right">'+
                '<ul>';
          if (login_nickname.usertype == 1) {
            val += '<li><i class="msg-icon iconfont nav-name">&#xe675;</i><span><a target="_blank" href="' + fn.urlgen("user_center", "revcomment") + '" rel="nofollow">'+ login_nickname.nickname +'</a></span></li>';
          } else if (login_nickname.usertype == 2) {
            val += '<li><i class="msg-icon iconfont nav-name">&#xe675;</i><span><a target="_blank" href="' + fn.urlgen("advisor_center") + '" rel="nofollow">'+ login_nickname.nickname +'</a></span></li>';
          }else if (login_nickname.usertype == 3) {
            val += '<li><i class="msg-icon iconfont nav-name">&#xe675;</i><span><a target="_blank" href="' + fn.urlgen("canzan_center") + '" rel="nofollow">'+ login_nickname.nickname +'</a></span></li>';
          }
          val += '<li><span class="bor">|</span></li>'+
              '<li ><a href="javascript:void(0)" style="background: #fff;" onclick="outlogin()" rel="nofollow">退出</a></li>'+
                '</ul>'+
                '</div>'+
                '</div>';
          $(".top").append(val);
        }

    //图片验证码

    $.ajax({
      url:"/param_code",
      type: "get",
      success: function(result){
        $('#param_code_user').html(result)
      },
      error:function(XMLHttpRequest, textStatus, errorThrown){
        console.log("获取失败，请重试！CODE:"+XMLHttpRequest.status)
      }
    });
    $('#tijiao').click(function () {
      var page_param = $('#param_code_value').val().toLowerCase();
      $.ajax({
        url:"/session_param_code",
        type: "post",
        data:{
          param_code: page_param
        },
        success: function(result){
          console.log('check param_code',result)
        },
        error:function(XMLHttpRequest, textStatus, errorThrown){
          console.log("获取失败，请重试！CODE:"+XMLHttpRequest.status)
        }
      });
    })

    $('.login_content').on('click','.login_nei_top div' , function () {
      var cur_index=$(this).index();
		  $(this).addClass('active').siblings().removeClass('active')
		  $(this).parents(".login_content").find('.m-t').hide().eq(cur_index).show();
    })

    // $("form").Vaild();
    $('.i-checks').iCheck({
      checkboxClass: 'icheckbox_square-green',
      radioClass: 'iradio_square-green'
    });
    var pc = document.getElementById('param_code_user');
    if (pc.addEventListener) {
      pc.addEventListener('click', showcode, false);
    } else {
      pc.attachEvent('onclick', showcode, false);
    }
    var lS = document.getElementById('loginSubmit');
    if (lS.addEventListener) {
      lS.addEventListener('click', loginS, false);
    } else {
      lS.attachEvent('onclick', loginS, false);
    }
    var sP = document.getElementById('sendcun_user');
    if (sP.addEventListener) {
      sP.addEventListener('click', sendphone_user, false)
    }else {
      sP.attachEvent('onclick', sendphone_user, false)
    }
    var pass = document.getElementById('loginSubmit_pass')
    if (pass.addEventListener) {
      pass.addEventListener('click', loginS_pass, false)
    } else {
      pass.attachEvent('onclick', loginS_pass, false)
    }

    $('#weibo_user').on('click', function () {
      var url = $(this).attr('data-url')
      //var h = window.location.href;//获取全部的url
      //console.log('h', h);
      //var hh = h.split("?");
      //console.log('hh', hh[1])
      if (url !== undefined) {
        //var str = hh[1].substr(1);
        //var strs = str.split("=");
        //console.log('strs', strs)
        var A = window.open(js_api_config.wwhost+ "/sina_login?h=" + url, "TencentLogin", "width=450,height=320,menubar=0,scrollbars=1,resizable=1,status=1,titlebar=0,toolbar=0,location=1");
      } else {
        var A = window.open(js_api_config.wwhost+ "/sina_login?h=" + js_api_config.wwhost, "TencentLogin", "width=450,height=320,menubar=0,scrollbars=1,resizable=1,status=1,titlebar=0,toolbar=0,location=1");
      }
    })
    $('#qq_user').on('click', function () {
    //以下为按钮点击事件的逻辑。注意这里要重新打开窗口
    //否则后面跳转到QQ登录，授权页面时会直接缩小当前浏览器的窗口，而不是打开新窗口
      var url = $(this).attr('data-url')
      //var h = window.location.href;//获取全部的url
      //console.log('h', h);
      //var hh = h.split("?");
      //console.log('hh', hh)
      if (url !== undefined) {
        //var str = hh[1].substr(1);
        //var strs = str.split("=");
        //console.log('strs', strs)
        var A = window.open(js_api_config.wwhost+"/qq_login?h=" + url, "TencentLogin", "width=695,height=475,menubar=0,scrollbars=1,resizable=1,status=1,titlebar=0,toolbar=0,location=1");
      } else {
        var A = window.open(js_api_config.wwhost+"/qq_login?h=" + js_api_config.wwhost, "TencentLogin", "width=450,height=320,menubar=0,scrollbars=1,resizable=1,status=1,titlebar=0,toolbar=0,location=1");
      }
    })

    
  })

  $(function () {
    //清除记录密码浏览器自带功能
     　
      document.getElementById('newEmail_pass').value='';
      document.getElementById('password').value='';
      document.getElementById('newEmail').value='';
      document.getElementById('tupian_user').value='';
      document.getElementById('verify_user').value='';
    
  })

  function showcode () {
    $.ajax({
      url:"/param_code?time="+new Date().getTime(),
      type: "get",
      success: function(result){
        //$('#param_code_user').html(result)
        $("#param_code_user")[0].innerHTML = result;
      },
      error:function(XMLHttpRequest, textStatus, errorThrown){
        console.log("获取失败，请重试！CODE:"+XMLHttpRequest.status)
      }
    });
  }

  //普通用户退出
function outlogin () {
  var login_info = JSON.parse(cookie('login_ss'));
  var h = window.location.href;
    // console.log('h', h);
    var hh = h.split("/");
    // console.log('hh[1]', hh[3]);
    var hhh = h.split("?");
    // console.log('hhh', hhh[1])
    $.ajax({
      url: '/login_out',
      type: 'GET',
      dataType:'jsonp',
      jsonpCallback:'cb',
      success:function(msg){
        if (msg == '0') {
          window.location.reload();
        }
      },
      error:function(XMLHttpRequest, textStatus, errorThrown){
        console.log("获取失败，请重试！CODE:"+XMLHttpRequest.status)
      }
    })
  }

//登录验证码
  function sendphone_user () {
    if ($('#newEmail').val() === '') {
//            let butp = document.getElementById('phone')
      // $('#newEmail').parent().addClass("has-error").removeClass("has-success");
      // $('#newEmail').data("toogle", "left").data("placement", "right").data("container", "body").data("content", '请输入手机号码').popover({"trigger":"manual"}).popover("show");
      $('#login_e_phone_u').css('display','block');
      return
    }
    if (!/^1\d{10}$/.test($("#newEmail").val())) {
//            let butp = document.getElementById('phone')
      // $('#newEmail').parent().addClass("has-error").removeClass("has-success");
      // $('#newEmail').data("toogle", "left").data("placement", "right").data("container", "body").data("content", '请输入正确手机号码').popover({"trigger":"manual"}).popover("show");
      $('#login_e_phone_u').css('display','block');
      $('#login_error_text_phone_u').html('请输入正确手机号码');
      return
    } else {
      $('#login_e_phone_u').css('display','none');
    }
    if ($('#tupian_user').val() == '') {
      layer.msg('请输入图片验证码');
      return
    }
    if (!/^[a-zA-Z0-9]{4}$/.test($("#tupian_user").val())) {
      layer.msg('请输入4位图片验证码');
      return
    }
    $.ajax({
//          url: '//192.168.100.77/api/sendcode/' + $('#phone').val(),
//    url: '//www.51daxuetong.cn/api/sendcode/' + $('#phone').val(),
//      url: ajaxUrlPrefix.ucapi + '/api/index.php?m=sendcode&phone=' + $('#newEmail').val(),
      url: '/sendcode_s',
      type:'post',
      data: {
        param_code: $('#tupian_user').val().toLowerCase(),
        phone: $('#newEmail').val()
      },
      dataType: 'json',
      withCredentials:true,
      success:function(msg){
        console.log('msg', msg);
        if (msg.code === 0) {
          layer.msg('短信发送成功，请查阅手机');
          var downcount = 60;
          var time = setInterval(function (){
            if (downcount === 0) {
              $("#sendcun_user").attr("value", "发送验证码");
              $("#sendcun_user").removeAttr("disabled");
              clearInterval(time);
              return
            }else {
              $("#sendcun_user").attr("disabled", "disabled");
              $("#sendcun_user").attr("value", downcount + "s");
              downcount--;
            }
          }, 1000);
        } else if (msg == '1') {
          layer.msg('图片验证码输入错误');
        } else if (msg.code === '1150013') {
          layer.msg(msg.message);
        }else {
          layer.msg('数据错误');
        }
      },
      error:function(XMLHttpRequest, textStatus, errorThrown){
        console.log("获取失败，请重试！CODE:"+XMLHttpRequest.status);
        layer.msg("获取失败，请重试！CODE:"+XMLHttpRequest.status);
      }
    });
    
  }

//验证码登录
function loginS () {
  var url = $(this).attr('data-url')
  console.log('url',url)
  console.log('login_ssssss')
  if ($('#newEmail').val() === '') {
    // $('#newEmail').parent().addClass("has-error").removeClass("has-success");
    // $('#newEmail').data("toogle", "left").data("placement", "right").data("container", "body").data("content", '请输入手机号').popover({"trigger":"manual"}).popover("show");
    $('#login_e_phone_u').css('display','block');
    return
  }
  // if (!/^[A-Za-z0-9]{6}$/.test($('#newEmail').val()) && !/^1\d{10}$/.test($('#newEmail').val())) {
  if (!/^1\d{10}$/.test($('#newEmail').val())) {
    // $('#newEmail').parent().addClass("has-error").removeClass("has-success");
    // $('#newEmail').data("toogle", "left").data("placement", "right").data("container", "body").data("content", '请输入正确手机号').popover({"trigger":"manual"}).popover("show");
    $('#login_e_phone_u').css('display','block');
    $('#login_error_text_phone_u').html('请输入正确手机号码');
    return
  } else {
    $('#login_e_phone_u').css('display','none');
  }
  if ($('#verify_user').val() === '') {
    layer.msg('请输入短信验证码');
    return
  }
  if (!/^\d{6}$/.test($("#verify_user").val())) {
    layer.msg('短信验证码位数不足');
    return
  }
  if (!$("#login_user input[type='checkbox']").is(':checked')) {
    layer.msg('请同意注册协议');
    return
  }
  if ($('#newEmail').val() !== '' && $('#verify_user').val() !== ''&& /^\d{6}$/.test($("#verify_user").val()) && /^1\d{10}$/.test($("#newEmail").val()) ) {
    console.log('ajax');
    $.ajax({
      url: '/login_user',
      type:'POST',
      data:{
        phone: $('#newEmail').val(),
        code: $('#verify_user').val(),
      },
      dataType:'json',
      success:function(msg){
        console.log('aaaaaaaaa')
        console.log('msg ajax', msg);
        if(msg.code === 0){
          //var h = location.search;//获取？后面的字符串
          //var h = window.location.href;//获取全部的url
          //console.log('h', h);
          //var hh = h.split("?");
          //console.log('hh', hh)
          if (url !== undefined) {
            //var str = hh[1].substr(1);
            //console.log('str', str);
            //var strs = str.split("=");
            //console.log('strs', strs[1]);
            window.location= url;
          } else {
            window.location = '/';
          }
          //alert('成功');
        } else {
          alert('金吉列提醒您：'+msg.message);
        }
      },
      error:function(XMLHttpRequest, textStatus, errorThrown){
        console.log("获取失败，请重试！CODE:"+XMLHttpRequest.status)
      }
    });

  }
};

//账户密码登录
function loginS_pass () {
  var url = $(this).attr('data-url')
  console.log('url',url)
  console.log('login_ssssss')
  if ($('#newEmail_pass').val() === '') {
    // $('#newEmail').parent().addClass("has-error").removeClass("has-success");
    // $('#newEmail').data("toogle", "left").data("placement", "right").data("container", "body").data("content", '请输入手机号').popover({"trigger":"manual"}).popover("show");
    $('#login_e_phone_p').css('display','block');
    $('#login_error_text_phone_p').html('请输入手机号码');
    return
  }
  // if (!/^[A-Za-z0-9]{6}$/.test($('#newEmail').val()) && !/^1\d{10}$/.test($('#newEmail').val())) {
  if (!/^1\d{10}$/.test($('#newEmail_pass').val())) {
    // $('#newEmail').parent().addClass("has-error").removeClass("has-success");
    // $('#newEmail').data("toogle", "left").data("placement", "right").data("container", "body").data("content", '请输入正确手机号').popover({"trigger":"manual"}).popover("show");
    $('#login_e_phone_p').css('display','block');
    $('#login_error_text_phone_p').html('请输入正确手机号码');
    return
  } else {
    $('#login_e_phone_p').css('display','none');
  }
  // if ($('#verify_user').val() === '') {
  //   layer.msg('请输入短信验证码');
  //   return
  // }
  // if (!/^\d{6}$/.test($("#verify_user").val())) {
  //   layer.msg('短信验证码位数不足');
  //   return
  // }
  if ($('#password').val() === '') {
    $('#login_e_phone_pp').css('display','block');
    return
  }
  if (!/^[a-zA-Z0-9]{8,16}$/.test($("#password").val())) {
    $('#login_e_phone_pp').css('display','block');
    $('#login_error_text_phone_pp').html('请输入8-16位数字+字母组成');
    return
  } else {
    $('#login_e_phone_pp').css('display','none');
  }
  if (!$("#login_user input[type='checkbox']").is(':checked')) {
    layer.msg('请同意注册协议');
    return
  }
  if ($('#newEmail_pass').val() !== '' && /^1\d{10}$/.test($("#newEmail_pass").val()) && $('#password').val() !== '' && /^[a-zA-Z0-9]{8,16}$/.test($("#password").val())) {
    console.log('ajax');
    $.ajax({
      url: '/user_login',
      type:'POST',
      data:{
        phone: $('#newEmail_pass').val(),
        password: hex_sha1($('#password').val()),
      },
      dataType:'json',
      success:function(msg){
        console.log('aaaaaaaaa')
        console.log('msg ajax', msg);
        if(msg.code === 0){
          //var h = location.search;//获取？后面的字符串
          //var h = window.location.href;//获取全部的url
          //console.log('h', h);
          //var hh = h.split("?");
          //console.log('hh', hh)
          if (url !== undefined) {
            //var str = hh[1].substr(1);
            //console.log('str', str);
            //var strs = str.split("=");
            //console.log('strs', strs[1]);
            window.location= url;
          } else {
            window.location = '/';
          }
          //alert('成功');
        } else {
          alert('金吉列提醒您：'+msg.message);
        }
      },
      error:function(XMLHttpRequest, textStatus, errorThrown){
        console.log("获取失败，请重试！CODE:"+XMLHttpRequest.status)
      }
    });

  }
};
  
</script>

</body>
</html>